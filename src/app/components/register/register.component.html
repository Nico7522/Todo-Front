<div class="register-form">
  <div class="title">
    <h2 class="white mat-headline-6">Register a account</h2>
  </div>
  <form [formGroup]="registerForm">
    <mat-grid-list [cols]="cols" rowHeight="100px">
      <mat-grid-tile [colspan]="cols">
        <mat-form-field>
          <mat-label id="email">Email</mat-label>
          <input
            formControlName="email"
            matInput
            type="text"
            name="email"
            id="email"
          />
          @if (hasErrorAndTouched(registerForm, 'email', 'required')) {
          <mat-error>Email required</mat-error>
          } @if (hasErrorAndTouched(registerForm, 'email', 'pattern')) {
          <mat-error>Email invalid</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="firstname">Firstname</mat-label>
          <input
            formControlName="firstname"
            matInput
            type="text"
            name="firstname"
            id="firstname"
          />
          @if (hasErrorAndTouched(registerForm, 'firstname', 'required')) {
          <mat-error>Firstname required</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="lastname">Lastname</mat-label>
          <input
            formControlName="lastname"
            matInput
            type="text"
            name="lastname"
            id="lastname"
          />
          @if (hasErrorAndTouched(registerForm, 'lastname', 'required')) {
          <mat-error>Lastname required</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="password">Password</mat-label>
          <input
            formControlName="password"
            matInput
            [type]="passwordFieldHide ? 'password' : 'text'"
            name="password"
            id="password"
          />
          <mat-icon
            matSuffix
            (click)="passwordFieldHide = !passwordFieldHide"
            >{{ passwordFieldHide ? "visibility_off" : "visibility" }}</mat-icon
          >
          @if (hasErrorAndTouched(registerForm, 'password', 'required')) {
          <mat-error>Password required</mat-error>
          } @if (hasErrorAndTouched(registerForm, 'password', 'pattern')) {
          <mat-error>Password invalid</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="passwordConfirm">Confirm password</mat-label>
          <input
            formControlName="passwordConfirm"
            matInput
            type="password"
            name="passwordConfirm"
            id="passwordConfirm"
            [type]="confirmPasswordFieldHide ? 'password' : 'text'"
            [errorStateMatcher]="passwordMatcher"
          />
          <mat-icon
            matSuffix
            (click)="confirmPasswordFieldHide = !confirmPasswordFieldHide"
            >{{
              confirmPasswordFieldHide ? "visibility_off" : "visibility"
            }}</mat-icon
          >
          @if (hasErrorAndTouched(registerForm, 'passwordConfirm', 'required'))
          {
          <mat-error>Confirm password required</mat-error>
          } @if (registerForm.errors?.['passwordMatchError']) {
          <mat-error>Password not match</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="birthdate">Birthdate</mat-label>
          <input
            formControlName="birthdate"
            matInput
            [matDatepicker]="birthdate"
            name="birthdate"
            id="birthdate"
          />
          <mat-hint>MM/DD/YYYY</mat-hint>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="birthdate"
          ></mat-datepicker-toggle>
          <mat-datepicker #birthdate></mat-datepicker>
          @if (hasErrorAndTouched(registerForm, 'birthdate', 'required')) {
          <mat-error>Birthdate required</mat-error> }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-form-field>
          <mat-label id="hiredate">Hiredate</mat-label>
          <input
            formControlName="hiredate"
            matInput
            [matDatepicker]="hiredate"
            name="hiredate"
            id="hiredate"
            [errorStateMatcher]="hireDatematcher"
          />
          <mat-hint>MM/DD/YYYY</mat-hint>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="hiredate"
          ></mat-datepicker-toggle>
          <mat-datepicker #hiredate></mat-datepicker>
          @if (hasErrorAndTouched(registerForm, 'hiredate', 'required')) {
          <mat-error>Hiredate required</mat-error> } @if
          (registerForm.errors?.['wrongHireDate']) {
          <mat-error>Hiredate must be higher than birthdate</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>

      <mat-grid-tile>
        <mat-form-field appearance="fill">
          <mat-label>Phone number</mat-label>
          <input-phone
            #phoneInput
            formControlName="phoneNumber"
            required
          ></input-phone>
          <mat-icon matSuffix>phone</mat-icon>
          @if ((this.registerForm.get('phoneNumber')?.errors)) {
          <mat-error>Invalid phone number</mat-error>
          }
        </mat-form-field>
      </mat-grid-tile>
      <mat-grid-tile>
        <button
          [disabled]="!this.registerForm.valid"
          (click)="handleSubmit()"
          mat-flat-button
          color="primary"
        >
          Submit
        </button>
      </mat-grid-tile>
    </mat-grid-list>
  </form>
  @if (errorMessage) {
  <span class="error">{{ errorMessage }}</span>
  }
</div>
